<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Qu·∫£n L√Ω Cafe</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="employees.css">
</head>
<body>
    <div id="app">
        <!-- Header v·ªõi tabs -->
        <header class="header">
            <div class="user-info">
                <button class="tab-btn active" data-tab="reports" title="B√°o c√°o">üìà</button>
                <button class="tab-btn" data-tab="inventory" title="Kho">üì¶</button>
                <button class="tab-btn" data-tab="statistics" title="Th·ªëng k√™">üìä</button>
                <button class="tab-btn" data-tab="employees" title="Nh√¢n vi√™n">üë•</button>
                <button class="tab-btn" data-tab="overview" title="T·ªïng quan">üëÅ</button>
                <button class="tab-btn" data-tab="settings" title="C√†i ƒë·∫∑t">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- N·ªôi dung ch√≠nh -->
        <main class="main-content">
            <!-- Tab B√°o c√°o -->
            <div id="reports" class="tab-content active"></div>

            <!-- Tab Kho -->
            <div id="inventory" class="tab-content"></div>

            <!-- Tab Th·ªëng k√™ -->
            <div id="statistics" class="tab-content"></div>

            <!-- Tab Nh√¢n vi√™n -->
            <div id="employees" class="tab-content"></div>

            <!-- Tab T·ªïng quan -->
            <div id="overview" class="tab-content"></div>

            <!-- Tab C√†i ƒë·∫∑t -->
            <div id="settings" class="tab-content"></div>
        </main>

        <!-- Popup container -->
        <div id="popupContainer" class="popup-container"></div>

        <!-- Loading overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading-spinner">ƒêang t·∫£i...</div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAcYhLhEiJk0WjQvQdwk0oNgyotp-ewKsk",
            authDomain: "milano259.firebaseapp.com",
            projectId: "milano259",
            storageBucket: "milano259.firebasestorage.app",
            messagingSenderId: "681812166818",
            appId: "1:681812166818:web:24e638784a239b0021effb",
            measurementId: "G-FSL6MSC7CT",
            databaseURL: "https://milano259-default-rtdb.asia-southeast1.firebasedatabase.app"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
    </script>

    <!-- Core scripts -->
     <script src="fix-issues.js"></script>
    <script src="database.js"></script>
    <script src="auth.js"></script>
    
    <!-- Feature scripts -->
    <script src="reports.js"></script>
    <script src="employees.js"></script>
    <script src="inventory.js"></script>
    <script src="statistics.js"></script>
    <script src="overview.js"></script>
    <script src="github-sync.js"></script>
    <script src="app.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                const user = getCurrentUser();
                if (!user) {
                    window.location.href = 'login.html';
                    return;
                }
                
                // ·∫®n loading
                setTimeout(() => {
                    const loading = document.getElementById('loadingOverlay');
                    if (loading) loading.style.display = 'none';
                }, 500);
                
                // Load tab ƒë·∫ßu ti√™n
                loadTabContent('reports');
                
            } catch (error) {
                console.error('App initialization error:', error);
                showErrorMessage(error);
            }
        });

        function loadTabContent(tabId) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });
            
            const tabContent = document.getElementById(tabId);
            if (tabContent) {
                tabContent.innerHTML = '<div class="tab-loading">ƒêang t·∫£i...</div>';
            }
            
            setTimeout(() => {
                switch(tabId) {
                    case 'reports':
                        if (typeof loadReports === 'function') loadReports();
                        break;
                    case 'inventory':
                        if (typeof loadInventory === 'function') loadInventory();
                        break;
                    case 'statistics':
                        if (typeof loadStatistics === 'function') loadStatistics();
                        break;
                    case 'employees':
                        if (typeof loadEmployeesData === 'function') loadEmployeesData();
                        break;
                    case 'overview':
                        if (typeof loadOverview === 'function') loadOverview();
                        break;
                    case 'settings':
                        if (typeof loadSettings === 'function') loadSettings();
                        break;
                }
            }, 100);
        }

        function showErrorMessage(error) {
            const loading = document.getElementById('loadingOverlay');
            if (loading) {
                loading.innerHTML = `
                    <div class="error-message">
                        <h3>‚ö†Ô∏è L·ªói kh·ªüi t·∫°o ·ª©ng d·ª•ng</h3>
                        <p>${error.message || 'Vui l√≤ng t·∫£i l·∫°i trang'}</p>
                        <button onclick="location.reload()" class="reload-btn">
                            T·∫£i l·∫°i trang
                        </button>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>